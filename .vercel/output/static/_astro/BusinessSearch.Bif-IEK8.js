import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.D55ewHcJ.js";import{s as v}from"./supabaseClient.BX-vlr2_.js";const E=[{value:"",label:"All categories"},{value:"food",label:"Food & Dining"},{value:"retail",label:"Retail"},{value:"services",label:"Services"},{value:"health",label:"Health"},{value:"nonprofit",label:"Nonprofit"}];function R(){const[u,N]=r.useState(""),[m,k]=r.useState(""),[h,w]=r.useState(!1),[c,f]=r.useState(!1),[l,g]=r.useState([]),[o,b]=r.useState(null),[i,S]=r.useState(!1),[d,_]=r.useState([]),[F,j]=r.useState(!0);r.useEffect(()=>{(async()=>{try{j(!0);const{data:t,error:n}=await v.from("businesses").select("*").eq("featured",!0).order("verified",{ascending:!1}).order("name",{ascending:!0});if(n){console.error(n);return}_(t||[])}catch(t){console.error(t)}finally{j(!1)}})()},[]);const C=async s=>{const t=(s?.location||"").trim(),n=s?.category||"",B=s?.verifiedOnly||!1;let a=v.from("businesses").select("*");if(t){const p=`%${t}%`;a=a.or(`city.ilike.${p},zip.ilike.${p},name.ilike.${p}`)}n&&(a=a.eq("category",n)),B&&(a=a.eq("verified",!0));const{data:q,error:x}=await a.order("verified",{ascending:!1}).order("name",{ascending:!0});if(x)throw console.error(x),x;return q||[]},$=async s=>{s.preventDefault(),f(!0),b(null),S(!0);try{const t=await C({location:u,category:m,verifiedOnly:h});g(t)}catch(t){console.error(t),b(t?.message||"Unexpected error occurred."),g([])}finally{f(!1)}},y=s=>e.jsxs("article",{className:"group flex h-full flex-col rounded-2xl border border-purple-900/60 bg-black/70 p-4 shadow-[0_0_30px_rgba(76,29,149,0.65)] transition hover:border-purple-400 hover:shadow-[0_0_40px_rgba(168,85,247,0.9)]",children:[e.jsxs("header",{className:"mb-2 flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-50",children:s.name}),e.jsxs("p",{className:"mt-1 text-[11px] text-slate-400",children:[s.category," â€¢"," ",s.area?e.jsxs(e.Fragment,{children:[s.area," â€¢ ",s.city,", ",s.state," ",s.zip]}):e.jsxs(e.Fragment,{children:[s.city,", ",s.state," ",s.zip]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.verified&&e.jsx("span",{className:"inline-flex items-center rounded-full bg-purple-500/20 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-purple-200",children:"Verified"}),s.featured&&e.jsx("span",{className:"inline-flex items-center rounded-full bg-amber-500/15 px-2 py-0.5 text-[9px] font-semibold uppercase tracking-wide text-amber-200",children:"Featured"})]})]}),e.jsx("p",{className:"text-xs text-slate-200",children:s.address}),s.description&&e.jsx("p",{className:"mt-2 line-clamp-3 text-xs text-slate-300",children:s.description}),e.jsxs("div",{className:"mt-3 space-y-1 text-xs text-slate-200",children:[s.phone&&e.jsxs("p",{children:["ðŸ“ž ",s.phone]}),s.website&&e.jsxs("p",{children:["ðŸŒ"," ",e.jsx("a",{href:s.website,target:"_blank",rel:"noreferrer",className:"text-purple-300 underline underline-offset-2 decoration-purple-400/80 hover:text-purple-200",children:"Visit website"})]})]})]},s.id);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("form",{onSubmit:$,className:"rounded-2xl border border-purple-900/80 bg-black/70 px-4 py-4 sm:px-6 sm:py-5 shadow-[0_0_35px_rgba(76,29,149,0.6)]",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-[2fr,1.5fr] sm:items-end",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-[11px] font-semibold uppercase tracking-wide text-slate-300",children:"Name, City, or ZIP"}),e.jsx("input",{type:"text",value:u,onChange:s=>N(s.target.value),placeholder:"e.g. Soul, Jacksonville, or 32205",className:"w-full rounded-xl border border-purple-900/70 bg-black/60 px-3 py-2 text-sm text-slate-50 outline-none ring-0 placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70 [color-scheme:dark]"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-[11px] font-semibold uppercase tracking-wide text-slate-300",children:"Category"}),e.jsx("select",{value:m,onChange:s=>k(s.target.value),className:"w-full rounded-xl border border-purple-900/70 bg-black/90 px-3 py-2 text-sm text-slate-50 outline-none focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70 [color-scheme:dark]",children:E.map(s=>e.jsx("option",{value:s.value,className:"bg-black text-slate-50",children:s.label},s.value||"all"))})]})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:s=>w(s.target.checked),className:"h-3 w-3 rounded border-purple-800 bg-black text-purple-500 focus:ring-purple-500/80"}),e.jsx("span",{children:"Show verified only"})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[e.jsx("button",{type:"submit",disabled:c,className:"inline-flex items-center justify-center rounded-xl bg-gradient-to-r from-purple-500 via-fuchsia-500 to-purple-400 px-4 py-2 text-sm font-semibold text-black shadow-[0_0_25px_rgba(147,51,234,0.8)] transition hover:brightness-110 disabled:opacity-60",children:c?"Searchingâ€¦":"Search"}),e.jsxs("p",{className:"text-[11px] text-slate-400",children:["Tip: Try a name like ",e.jsx("span",{className:"font-mono text-purple-300",children:"Soul"})," or a ZIP like ",e.jsx("span",{className:"font-mono text-purple-300",children:"32205"}),"."]})]})]})]}),o&&e.jsx("p",{className:"rounded-xl border border-red-500/50 bg-red-950/50 px-3 py-2 text-xs text-red-100",children:o}),!o&&i&&!c&&e.jsx("div",{className:"flex items-center justify-between text-[11px] text-slate-300",children:e.jsx("span",{children:l.length===0?"No businesses found. Try broadening your search.":`Showing ${l.length} business${l.length===1?"":"es"}.`})}),!i&&!F&&d.length>0&&e.jsxs("section",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-slate-400",children:"Start here â€¢ Featured in Jacksonville"}),e.jsx("span",{className:"text-[10px] text-slate-500",children:"Curated set of Black-owned spots to check out first."})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:d.map(s=>y(s))})]}),i&&e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:l.map(s=>y(s))}),!i&&l.length===0&&d.length===0&&e.jsx("p",{className:"text-[11px] text-slate-400",children:"Use the search above to discover Black-owned businesses in your area."})]})}export{R as default};
