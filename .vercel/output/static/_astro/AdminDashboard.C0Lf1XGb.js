import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.D55ewHcJ.js";const _=[{value:"food",label:"Food & Dining"},{value:"retail",label:"Retail"},{value:"services",label:"Services"},{value:"health",label:"Health"},{value:"nonprofit",label:"Nonprofit"}];function V({suggestions:v}){const[d,m]=n.useState(v||[]),[b,p]=n.useState(null),[g,f]=n.useState(null),[h,r]=n.useState(null),[j,i]=n.useState(null),[u,w]=n.useState(""),k=async(t,l)=>{t.preventDefault(),r(null),i(null),p(l);const a=t.currentTarget,s=new FormData(a),c={suggestionId:l,name:s.get("name")?.trim(),category:s.get("category")||"services",address:s.get("address")?.trim()||null,city:s.get("city")?.trim()||null,state:s.get("state")?.trim()||null,zip:s.get("zip")?.trim()||null,phone:s.get("phone")?.trim()||null,website:s.get("website")?.trim()||null,description:s.get("description")?.trim()||null,verified:s.get("verified")==="on"};if(!c.name){r("Name is required."),p(null);return}try{const o=await fetch("/api/promote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),F=await o.json().catch(()=>({}));if(!o.ok){r(F?.error||"Failed to promote suggestion.");return}m(P=>P.filter(R=>R.id!==l)),i("Suggestion promoted successfully."),a.reset()}catch(o){console.error(o),r("Unexpected error promoting suggestion.")}finally{p(null)}},S=async t=>{if(r(null),i(null),!!window.confirm("Reject and remove this suggestion?")){f(t);try{const a=await fetch("/api/reject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({suggestionId:t})}),s=await a.json().catch(()=>({}));if(!a.ok){r(s?.error||"Failed to reject suggestion.");return}m(c=>c.filter(o=>o.id!==t)),i("Suggestion rejected and removed.")}catch(a){console.error(a),r("Unexpected error rejecting suggestion.")}finally{f(null)}}},x=u.trim().toLowerCase(),y=x?d.filter(t=>[t.name,t.city??"",t.state??"",t.notes??"",t.website??""].join(" ").toLowerCase().includes(x)):d,N=d.length,C=y.length;return N?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"text-[11px] text-slate-300",children:[e.jsxs("span",{className:"font-semibold text-slate-100",children:[C," / ",N]})," ","suggestions visible",x&&e.jsxs("span",{className:"text-slate-500",children:[" (filtered by “",u,"”)"]})]}),e.jsx("input",{type:"text",value:u,onChange:t=>w(t.target.value),placeholder:"Filter by name, city, notes…",className:"w-full max-w-xs rounded-lg border border-purple-900/70 bg-black/60 px-3 py-1.5 text-[11px] text-slate-50 outline-none placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70"})]}),h&&e.jsx("p",{className:"rounded-xl border border-red-500/50 bg-red-950/50 px-3 py-2 text-xs text-red-100",children:h}),j&&e.jsx("p",{className:"rounded-xl border border-emerald-500/40 bg-emerald-950/40 px-3 py-2 text-xs text-emerald-100",children:j}),e.jsx("div",{className:"grid gap-4",children:y.map(t=>e.jsxs("article",{className:"rounded-2xl border border-purple-900/50 bg-black/70 p-4 sm:p-5 shadow-[0_0_25px_rgba(76,29,149,0.6)]",children:[e.jsxs("header",{className:"mb-3 flex flex-col gap-1 sm:flex-row sm:items-baseline sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-50",children:t.name}),e.jsxs("p",{className:"text-[11px] text-slate-400",children:["Suggested ",new Date(t.created_at).toLocaleString()]})]}),e.jsx("div",{className:"text-[11px] text-slate-400",children:t.city&&t.state?e.jsxs("span",{children:[t.city,", ",t.state]}):e.jsx("span",{className:"italic text-slate-500",children:"Location not provided"})})]}),e.jsxs("form",{onSubmit:l=>k(l,t.id),className:"space-y-3 text-xs text-slate-100",children:[e.jsxs("div",{className:"grid gap-3 sm:grid-cols-[2fr,1fr]",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-[11px] font-medium text-slate-300",children:"Business name *"}),e.jsx("input",{name:"name",defaultValue:t.name,className:"w-full rounded-lg border border-purple-900/70 bg-black/60 px-3 py-1.5 text-xs outline-none placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-[11px] font-medium text-slate-300",children:"Category"}),e.jsx("select",{name:"category",defaultValue:"services",className:"w-full rounded-lg border border-purple-900/70 bg-black/60 px-3 py-1.5 text-xs outline-none focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70 [color-scheme:dark]",children:_.map(l=>e.jsx("option",{value:l.value,className:"bg-black text-slate-50",children:l.label},l.value))})]})]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-[2fr,1fr]",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-[11px] font-medium text-slate-300",children:"Address"}),e.jsx("input",{name:"address",className:"w-full rounded-lg border border-purple-900/70 bg-black/60 px-3 py-1.5 text-xs outline-none placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70",placeholder:"Street address"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-[11px] font-medium text-slate-300",children:"City"}),e.jsx("input",{name:"city",defaultValue:t.city||"",className:"w-full rounded-lg border border-purple-900/70 bg-black/60 px-2 py-1.5 text-xs outline-none placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-[11px] font-medium text-slate-300",children:"State"}),e.jsx("input",{name:"state",defaultValue:t.state||"FL",maxLength:2,className:"w-full rounded-lg border border-purple-900/70 bg-black/60 px-2 py-1.5 text-xs uppercase outline-none placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-[11px] font-medium text-slate-300",children:"ZIP"}),e.jsx("input",{name:"zip",className:"w-full rounded-lg border border-purple-900/70 bg-black/60 px-2 py-1.5 text-xs outline-none placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70"})]})]})]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-[11px] font-medium text-slate-300",children:"Phone"}),e.jsx("input",{name:"phone",className:"w-full rounded-lg border border-purple-900/70 bg-black/60 px-3 py-1.5 text-xs outline-none placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70",placeholder:"e.g. 904-555-1234"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-[11px] font-medium text-slate-300",children:"Website or social link"}),e.jsx("input",{name:"website",defaultValue:t.website||"",className:"w-full rounded-lg border border-purple-900/70 bg-black/60 px-3 py-1.5 text-xs outline-none placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70",placeholder:"https://..."})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-[11px] font-medium text-slate-300",children:"Description"}),e.jsx("textarea",{name:"description",defaultValue:t.notes||"",rows:3,className:"w-full rounded-lg border border-purple-900/70 bg-black/60 px-3 py-1.5 text-xs outline-none placeholder:text-slate-500 focus:border-purple-400 focus:ring-2 focus:ring-purple-500/70",placeholder:"Short description for the directory listing"})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-slate-300",children:[e.jsx("input",{type:"checkbox",name:"verified",defaultChecked:!0,className:"h-3 w-3 rounded border-purple-800 bg-black text-purple-500 focus:ring-purple-500/80"}),e.jsx("span",{children:"Mark as verified Black-owned"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>S(t.id),disabled:g===t.id,className:"inline-flex items-center justify-center rounded-lg border border-red-500/70 bg-black px-3 py-1.5 text-[11px] font-semibold text-red-300 hover:bg-red-950/40 disabled:opacity-60",children:g===t.id?"Rejecting…":"Reject"}),e.jsx("button",{type:"submit",disabled:b===t.id,className:"inline-flex items-center justify-center rounded-lg bg-purple-500 px-3 py-1.5 text-[11px] font-semibold text-black shadow-[0_0_18px_rgba(147,51,234,0.8)] hover:brightness-110 disabled:opacity-60",children:b===t.id?"Promoting…":"Promote to directory"})]})]})]})]},t.id))})]}):e.jsxs("div",{className:"rounded-2xl border border-purple-900/40 bg-black/60 px-4 py-4 sm:px-5 sm:py-5 text-sm text-slate-200",children:[e.jsx("p",{children:"No suggestions waiting for review."}),e.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"When supporters submit new businesses, they will appear here."})]})}export{V as default};
